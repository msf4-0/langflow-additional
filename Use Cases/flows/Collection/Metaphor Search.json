{"id":"ef540ad4-3e64-4698-b19f-0304cfd144e2","name":"Metaphor Search","data":{"edges":[],"nodes":[{"data":{"type":"CustomComponent (rSplF)","node":{"template":{"code":{"dynamic":true,"required":true,"placeholder":"","show":true,"multiline":true,"value":"from langflow import CustomComponent\nfrom typing import List, Union\nfrom langchain.llms.base import BaseLLM\nfrom langchain.chains import LLMChain\nfrom langchain import PromptTemplate\nfrom langchain.schema import Document\nfrom metaphor_python import Metaphor\nimport json\n\nfrom typing import List\nfrom langflow.field_typing import Data\n\nclass MetaphorSearch(CustomComponent):\n    display_name: str = \"Metaphor Search\"\n    description: str = \"Search in Metaphor with a custom string.\"\n    beta = True\n    \n    def build_config(self):\n        return {\n        \"metaphor_client\": {\"display_name\": \"Metaphor Wrapper\"},   \n        \"search_num_results\": {\"display_name\": \"Number of Results (per domain)\"},\n        \"include_domains\": {\"display_name\": \"Include Domains\",  \"is_list\": True},\n        \"start_date\": {\"display_name\": \"Start Date\"},\n        \"use_autoprompt\": {\"display_name\": \"Use Autoprompt\", \"type\": \"boolean\"},\n        \"search_type\": {\"display_name\": \"Search Type\", \"options\": [\"neural\", \"keyword\"]},\n        \"start_date\": {\"input_types\": [\"Data\"]}\n    }\n\n    def build(\n        self,\n        methaphor_client: Data,\n        query: str,\n        search_type: str='keyword',\n        search_num_results: int = 5,\n        include_domains: List[str]= [\"youtube.com\"],\n        use_autoprompt: bool = False,\n        start_date: str=\"2023-01-01\",\n        \n    ) -> Data:\n        \n        results = []\n        for domain in include_domains:\n            response = methaphor_client.search(\n                    query,\n                    num_results=int(search_num_results),\n                    include_domains=[domain],\n                    use_autoprompt=use_autoprompt,\n                    type=search_type,\n                    # start_crawl_date=start_date,\n                    start_published_date=start_date\n                )\n            results.extend(response.results)\n    \n        self.repr_value = results\n\n        return results\n\n","password":false,"name":"code","advanced":false,"type":"code","list":false},"_type":"CustomComponent","include_domains":{"required":true,"placeholder":"","show":true,"multiline":false,"value":["youtube.com"],"password":false,"name":"include_domains","display_name":"Include Domains","advanced":false,"dynamic":false,"info":"","type":"str","list":true},"methaphor_client":{"required":true,"placeholder":"","show":true,"multiline":false,"password":false,"name":"methaphor_client","display_name":"methaphor_client","advanced":false,"dynamic":false,"info":"","type":"Data","list":false},"query":{"required":true,"placeholder":"","show":true,"multiline":false,"password":false,"name":"query","display_name":"query","advanced":false,"dynamic":false,"info":"","type":"str","list":false,"value":"pastel"},"search_num_results":{"required":true,"placeholder":"","show":true,"multiline":false,"value":5,"password":false,"name":"search_num_results","display_name":"Number of Results (per domain)","advanced":false,"dynamic":false,"info":"","type":"int","list":false},"search_type":{"required":true,"placeholder":"","show":true,"multiline":false,"value":"keyword","password":false,"options":["neural","keyword"],"name":"search_type","display_name":"Search Type","advanced":false,"dynamic":false,"info":"","type":"str","list":true},"start_date":{"required":true,"placeholder":"","show":true,"multiline":false,"value":"","password":false,"name":"start_date","display_name":"start_date","advanced":false,"input_types":["Data"],"dynamic":false,"info":"","type":"str","list":false},"use_autoprompt":{"required":true,"placeholder":"","show":true,"multiline":false,"value":false,"password":false,"name":"use_autoprompt","display_name":"Use Autoprompt","advanced":false,"dynamic":false,"info":"","type":"bool","list":false}},"description":"Search in Metaphor with a custom string.","base_classes":["Data"],"display_name":"Metaphor Search (2)","custom_fields":{"include_domains":null,"methaphor_client":null,"query":null,"search_num_results":null,"search_type":null,"start_date":null,"use_autoprompt":null},"output_types":["Data"],"documentation":"","beta":true,"error":null,"official":false},"id":"CustomComponent (rSplF)-zSUGJ"},"id":"CustomComponent (rSplF)-zSUGJ","position":{"x":0,"y":0},"type":"genericNode"}],"viewport":{"x":1,"y":1,"zoom":1}},"is_component":true}