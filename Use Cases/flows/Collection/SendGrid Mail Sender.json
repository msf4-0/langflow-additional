{"id":"148ead7c-01b7-4d9a-93aa-eb631dad41cf","name":"SendGrid Mail Sender","data":{"edges":[],"nodes":[{"data":{"type":"CustomComponent","node":{"template":{"code":{"dynamic":true,"required":true,"placeholder":"","show":true,"multiline":true,"value":"from langflow import CustomComponent\n\nfrom langflow.field_typing import (\n    Tool,\n    PromptTemplate,\n    Chain,\n    BaseChatMemory,\n    BaseLLM,\n    BaseLoader,\n    BaseMemory,\n    BaseOutputParser,\n    BaseRetriever,\n    VectorStore,\n    Embeddings,\n    TextSplitter,\n    Document,\n    AgentExecutor,\n    NestedDict,\n    Data,\n)\n\n\nclass Component(CustomComponent):\n    display_name: str = \"SendGrid Mail Sender\"\n    description: str = \"Send any e-mail via SendGrid with an API key\"\n    \n    def build_config(self):\n        return {\"api_key\": {\"password\": True}, \"body\": {\"input_types\": [\"Data\"]}}\n\n    def build(self, requirements:Document, api_key:str, body:str, from_email:str=\"no-reply@logspace.ai\", to_email:str=\"rodrigosilvanader@gmail.com\", subject:str=\"Langflow News - Found Links\") -> Data:\n        requirements\n        \n        import sendgrid\n        from sendgrid.helpers.mail import Mail, Email, To, Content\n        \n        sg = sendgrid.SendGridAPIClient(api_key)\n        from_email = Email(from_email)\n        to_email = To(to_email)\n        \n        \n        # Just for metaphor\n        processed_body = \"<body><html>\"\n        for r in body:\n            processed_body += \"<p>\" + r.title + \"</p><p><a href=\" + r.url + \">Click here</a> to see.</p>\"\n            processed_body += \"<p>\" + st(r.score) + \"</p>\"\n\n        processed_body += \"</body></html>\"\n        \n        content = Content(\"text/html\", str(processed_body))\n        mail = Mail(from_email, to_email, subject, content)\n\n        try:\n            response = sg.client.mail.send.post(request_body=mail.get())\n            return f\"Email sent! Status code: {response.status_code}\"\n        except Exception as e:\n            return f\"Error: {e}\"\n        ","password":false,"name":"code","advanced":false,"type":"code","list":false},"_type":"CustomComponent","api_key":{"required":true,"placeholder":"","show":true,"multiline":false,"password":true,"name":"api_key","display_name":"api_key","advanced":false,"dynamic":false,"info":"","type":"str","list":false,"value":""},"body":{"required":true,"placeholder":"","show":true,"multiline":false,"password":false,"name":"body","display_name":"body","advanced":false,"input_types":["Data"],"dynamic":false,"info":"","type":"str","list":false,"value":""},"from_email":{"required":true,"placeholder":"","show":true,"multiline":false,"value":"no-reply@logspace.ai","password":false,"name":"from_email","display_name":"from_email","advanced":false,"dynamic":false,"info":"","type":"str","list":false},"requirements":{"required":true,"placeholder":"","show":true,"multiline":false,"password":false,"name":"requirements","display_name":"requirements","advanced":false,"dynamic":false,"info":"","type":"Document","list":false},"subject":{"required":true,"placeholder":"","show":true,"multiline":false,"value":"Langflow News - Found Links","password":false,"name":"subject","display_name":"subject","advanced":false,"dynamic":false,"info":"","type":"str","list":false},"to_email":{"required":true,"placeholder":"","show":true,"multiline":false,"value":"rodrigosilvanader@gmail.com","password":false,"name":"to_email","display_name":"to_email","advanced":false,"dynamic":false,"info":"","type":"str","list":false}},"description":"Send any e-mail via SendGrid with an API key","base_classes":[],"display_name":"SendGrid Mail Sender","custom_fields":{"api_key":null,"body":null,"from_email":null,"requirements":null,"subject":null,"to_email":null},"output_types":[],"documentation":"","beta":true,"error":null,"official":false},"id":"CustomComponent-fcgst"},"id":"CustomComponent-fcgst","position":{"x":0,"y":0},"type":"genericNode"}],"viewport":{"x":1,"y":1,"zoom":1}},"is_component":true}